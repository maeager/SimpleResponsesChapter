
\graphicspath{{/media/data/Work/cnstellate/DS_ClickRecovery/}{/media/data/Work/Responses/}}
\section[DS Cell Model]{D-Stellate Cell Model: optimisation using click recovery responses}
\label{sec:d-stellate-cell-model}


This section shows the GABAergic input and intrinsic
cell properties  influence the behaviour Onset chopper units.
Onset-chopper units in the mammalian VCN have a wide-ranging influence
on the primary cells of the VCN (stellate and bushy neurons \citep{RhodeSmithEtAl:1983}), the
ipsilateral DCN (type II and type IV EIRA units) and the contralateral CN \citep{NeedhamPaolini:2007}.  

\medskip{}


% Large multipolar or stellate cells in the VCN have been shown to have
% 3-4 long dendrites stretching 200 microns (or one third of the VCN)
% and their axonal collaterals cover the same region in the VCN, almost
% one half of the DCN, and are one source of the commisural projection
% to the contralateral cochlear nucleus.



%%%%%%%%%%%%%%%%%%%Copied from original jneurometh article



\subsection{Background}

  
D-stelate (DS) cells have an onset-chopping (On-C) PSTH to tones and noise
\citep{SmithRhode:1989,NeedhamPaolini:2006}. Intracellular responses to sounds
indicate the bandwidth of inputs to DS neurons typically ranges from two
octaves below CF to one octave above CF
\citep{PalmerJiangEtAl:1996,PaoliniClark:1999}. DS cell axon terminals contain
the inhibitory neurotransmitter glycine and synapse widely in the VCN and DCN.
They also send a commissural projection to the contralateral cochlear nucleus
that mediates fast inhibition between the nuclei
\citep{NeedhamPaolini:2003,NeedhamPaolini:2006}.  \citep{Oertel:1997}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Post-onset GABAergic inhibition in DS cells is a major influence on the PSTH
of On-C neurons \citep{FerragamoGoldingEtAl:1998a,EvansZhao:1998}. Latency of
excitation to auditory nerve shocks suggests golgi cells are activated by type
II ANFs and low spontaneous rate type I ANFs
\citep{BensonBerglundEtAl:1996,FerragamoGoldingEtAl:1998}. Therefore, type II
and LS type I ANFs could be involved in gain control through GABAergic
modulation of activity in the VCN.


\medskip{}

[Discuss AM coding by DS cells]
\citep{CasparyPalombiEtAl:2002} GABA blockers in the VCN has the effects of changing the behaviour in the response to AM in the IC.
\citep{BackoffShadduckEtAl:1999} AM coding effects of GABA in the Chinchilla CN.
\citep{CasparyBackoffEtAl:1994}
Caspary et al. worked on the effects of GABA in in the VCN. 

Zhang and Winter looked at the response area of VCN onset units to determine GABA on/off freq

Smith and Rhode, Smith et al. looked at OnC respnse area and two-tone



\subsection{Implementation}
 
Key factors in designing D-stellate cell model

\medskip{}

Choosing neural model: type I-II Rothman and Manis model
  - with/without dendrites
  - variable KLT, leak conductance

\begin{itemize}
\item  ANF spread to DS cells well documented (decision made to
    fix params due to large computational task of calc response area) 
\item  short delay recovery responses (2,3,4 ms) were not successful upon
    first model, included DS leak and KLT conductances to allow cell
    behaviour to be fit
  \item The effect of Golgi cells on DS is delayed by the extra 0.7 ms
    delay from ANF to Golgi, plus the slow peak of \GABAa inhibition.
\end{itemize}

\medskip{}

Optimisation parameters for \GLGDS are optimised based on experimental
click recovery data from \citep{BackoffPalombiEtAl:1997}.  Fixed
parameters included the number of golgi cells to DS cells ($\nGLGDS =
25$), the spread of ANFs to DS cells $\ANFDS$, and the extra delay from the auditory
nerve.  The first spike latency in DS cells 2.8 Â± 0.09 ms
\citep{RhodeSmith:1986}.The addition of 0.5 ms to \ANFDS connections
is a combination of conductance and synaptic delay. The effect of
Golgi cells on DS is delayed by the extra 0.7~ms delay from ANF to
Golgi, plus the slow peak of \GABAa inhibition.  
The spread ANF to DS cells (\sANFDSh,\sANFDSl) is arbitrary at this point and fairly broad so the
estimate is set so that 2 octaves below and 1 octave above CF are
within 2 standard deviations \citep{PaoliniClark:1999}.

\medskip{}

The optimisation function was a weighted mean squared error between
the experimental and simulated data, from an array where the elements
were the number of spikes in a 2 ms window after a click.  The input
stimulus was a series of masker/response clicks, with the click
intervals of 2, 3, 4, 8, 16 ms, and a separation of 50 ms.


\noindent
\begin{tabularx}{\textwidth}{|l|X|}\hline %
%
\hdr{2}{A}{Model Summary}\\\hline
\textbf{Populations}     & ANF (HSR,LSR), Golgi, D-stellate \\\hline
\textbf{Topology}        & Tonotopic,  Auditory system of the rat  \\\hline
\textbf{Connectivity}    & Gaussian spread dependent on morphology and afferent connections  \\\hline
\textbf{Input model}  &  ANF phenomenological instantaneous-rate Poisson spike trains\citep{ZilanyBruceEtAl:2009}\\\hline
\multirow{2}{*}{\textbf{Neuron model}}    & Golgi: instantaneous-rate Poisson spike trains\\
&D-stellate: HH-like single-compartment model (Type 1-2 RM model)\\ \hline
\textbf{Channel models}  & $I_{\textrm{Na}}$, $I_{\textrm{KHT}}$, $I_{\textrm{KLT}}$, $I_{\textrm{KA}}$ and $I_{\textrm{h}}$ \citep{RothmanManis:2003b} \\\hline
\textbf{Synapse model}   & Conductance synapses: excitatory (single-exponential), GABAergic (double-exponential) \\\hline
\textbf{Input Stimulus}  & Mask/Recovery click trains with delay 2, 3, 4 and 8
ms, separated by 50 ms\\\hline
\textbf{Measurements}    & PSTH sampled at each recovery click for 2 ms to measure click recovery\\\hline
\end{tabularx}
\vspace{2ex}

% - B -----------------------------------------------------------------------------

\noindent
\begin{tabularx}{\textwidth}{|l|X|X|}\hline %{\textwidth}
\hdr{3}{B}{Populations}\\\hline
\textbf{Name} &            \textbf{Elements}            & \textbf{Number} \\\hline
     HSR      &            Poisson generator with refractory effects           & $N_{\text{HSR}} = 50$ per freq.\ channel \\\hline
     LSR      &            ''            & $N_{\text{LSR}}= 20$  per freq.\ channel \\\hline
     GLG      &            ''            & $N_{\text{GLG}}= 1$  per freq.\ channel  \\\hline
     DS       &  Type I-II RM model & $N_{\text{DS}}= 1$ at CF=5.6~kHz \\\hline
\end{tabularx}
\vspace{2ex}

% - C ------------------------------------------------------------------------------

\noindent
\begin{tabularx}{\textwidth}{|l|l|l|X|}\hline
\hdr{4}{C}{Connectivity}\\\hline
        \textbf{Name}          &  \textbf{Source}  & \textbf{Target} & \textbf{Pattern} \\\hline
$\textrm{ANF} \to \textrm{DS}$ & ANF (HSR and LSR) &   D-Stellate    & skewed Gaussian, centered at CF, spread below CF \sANFDSl, spread above CF \sANFDSh, uniform weight \wANFDS for all synapses, number \nLSRDS and \nHSRDS, delay \dANFDS \\\hline
$\textrm{GLG} \to \textrm{DS}$ &       Golgi       &   D-Stellate    & Gaussian, centered at CF with spread \sGLGDS, uniform weight \wGLGDS, number \nGLGDS, delay \dGLGDS \\\hline
\end{tabularx}

\vspace{2ex}




% - D ------------------------------------------------------------------------------



%\noindent\begin{tabularx}{\textwidth}{|p{0.150.95\textwidth}|X|}\hline
%\hdr{2}{D}{Neuron and Synapse Model}\\\hline
% \textbf{Name} & Poisson spike generator \\\hline
% \textbf{Type} & Leaky integrate-and-fire, $\delta$-current input\\\hline
% \raisebox{-4.5ex}{\parbox{\textwidth}{\textbf{Subthreshold dynamics}}} &
% \rule{1em}{0em}\vspace*{-3.5ex}
%     \begin{equation*}
%       \begin{array}{r@{\;=\;}lll}
% \tau \dot{V}(t) & -V(t) + R I(t) & \text{if} & t > t^*+\tau_{\text{rp}} \\
%      V(t)       &  V_{\text{r}}  & \text{else} \\[2ex]
%      I(t)       & \multicolumn{3}{l}{\frac{\tau}{R} \sum_{\tilde{t}} w \delta(t-(\tilde{t}+\Delta))}
% \end{array}
%     \end{equation*}
% \vspace*{-2.5ex}\rule{1em}{0em}
%  \\\hline
 % \multirow{3}{*}{\textbf{Spiking}} &   If $V(t-)<\theta \wedge V(t+)\geq \theta$ \vspace*{-1ex}
 % \begin{enumerate}\setlength{\itemsep}{-0.5ex}
 % \item set $t^* = t$
 % \item emit spike with time-stamp $t^*$
 % \end{enumerate}
 % \vspace*{-4ex}\rule{1em}{0em} \\\hline
 % \end{tabularx}

\vspace{2ex}

% - E ------------------------------------------------------------------------------

\noindent
\begin{tabularx}{\textwidth}{|X|c|c|c|}\hline %{\textwidth}
\hdr{4}{E}{Optimisation} \\ \hline
     \textbf{Parameters}      &  \textbf{Name}   &        \textbf{Range}         & \textbf{Best Values} \\\hline 
     Weight of GLG on DS (nS)      &     \wGLGDS      &         [0.01,50]          & 0.532 \\	\hline	
   Weight of HSR syn on DS (nS)	  &	\wHSRDS	     &		[0.01,50]	   & 0.16 \\	   \hline
   Weight of LSR syn on DS  (nS)  &	\wLSRDS	     &		[0.01,50]	   & 13.1 \\	    \hline
\GABAa synapse rise constant  (ms)&  $\tau_{GABA1}$  &	       [0.01,10.0]	   & 5.432\\	     \hline
\GABAa synapse decay constant (ms)&  $\tau_{GABA2}$  &	       [0.1,50.0]	   & 0.262\\	    \hline
  DS cell leak conductance (mS per cm$^2$)   & $\bar{g}_{leak}$ & [1e-5,5e-2]  & 0.0163 \\ \hline
\end{tabularx}
\vspace{2ex}




% - F -----------------------------------------------------------------------------

\noindent\begin{tabularx}{\textwidth}{|X|}\hline
  \hdr{1}{F}{Measurements}\\\hline 
PSTHs were generated from 25
  stimulus repetitions. Each response to a click is measured for 2 ms
  after the minimum first spike latency for the unit.  The unit used
  in the optimisation has a CF = 5.8~kHz (channel no. 50).\\ \hline
% \begin{minipage}[c]{0.6\textwidth}
% \vspace{1cm}
% DS Ouput \hspace{2in} Golgi Output
% %\includegraphics[width=0.5\textwidth]{DS_ClickRecovery_DSpsth}\label{Ch3:fig:DSClickRecoveryPSTH}\includegraphics[width=0.5\textwidth]{DS_ClickRecovery_Gpsth}\label{Ch3:fig:DSClickRecoveryPSTH}\\
%   \captionsize{PSTH response of a D-stellate cell from the click recovery stimulus used in the optimisation.}
%   \end{minipage}\\ \hline
\end{tabularx}

 % ---------------------------------------------------------------------------------
% \newpage
% \begin{lstlisting}
% func fun() {local f
%       //Modify Variables
%       param.w.x[glg][ds] = $2
%       param.w.x[hsr][ds] = $3
%       param.w.x[lsr][ds] = $3
%       //Modify the network
%       {create_cells() connect_cells(fileroot) SetRates()}
%       // Simulate the network for N reps
%       for j=0, reps-1{
%          print j
%          GenSpikes()
%          run()
%          DSvec.append(dstellate[50][0].spiketimes)
%          //print startsw()-x, "secs"
%       }
%       DSvec = DSvec.histogram(0,tstop,0.1)
%
%       objref errorvec
%       errorvec = new Vector()
%       //Find the mean number of spikes in the first click
%       maxrate = (DSvec.sum(240,260) + DSvec.sum(740,760)+ DSvec.sum(1340,1360))/3
%       //Calc ratio of number of spikes in second click relative to mean first click
%       errorvec.append( DSvec.sum(260,280) / maxrate )
%       errorvec.append( DSvec.sum(780,800) / maxrate )
%       errorvec.append( DSvec.sum(1420,1440) / maxrate )
%       errorvec.plot(g
%     return errorvec.meansqerr(targetclick)
% }
% \end{lstlisting}











\begin{figure}[htb]
\includegraphics[angle=-90,width=0.8\textwidth]{DSClickRecoveryExpData}\label{Ch3:fig:DSClickRecoveryExpData}
\caption{Experimental Data of GABAergic influence on D-stellate cells from \citep{BackoffPalombiEtAl:1997}, Fig.~3.}
\end{figure}

%\parsep

% From the command line type:
% \begin{verbatim}
% $ ./i686/special DS_ClickRecovery.hoc
% \end{verbatim}
% in the \texttt{cnstellate} directory to simulate the optimisation for D-stellate click recovery.  The first run may take some time if the AN filters have not been previously saved, since the Zilany \& Bruce model requires 500~kHz resolution in the stimulus that is downsampled to 50~kHz.

\clearpage
\subsection{Results}


% \noindent\begin{tabularx}{\textwidth}{|l|X|}\hline %{\textwidth}
% \hdr{2}{D}{Results} \\\hline
% \end{minipage}}\\\hline
% \textbf{Error} & 0.006671    unweighted (MSE of recovery spike rate / mask rate)\\\hline
% & 0.01447    final result (MSE of recovery spike rate / mask rate)\\\hline
% \end{tabularx}

\begin{figure}[hp!]
  \centering
\includegraphics[keepaspectratio=true,angle=-90,width=0.9\textwidth]{./gfx/DS_ClickRecovery_result.eps}
%\includegraphics[keepaspectratio,angle=-90,width=0.8\textwidth]{./gfx/DSClickRecoveryExpData}\\
\caption{Experimental Data ({\color{green} Green}) of GABAergic influence on D-stellate cells from \citep{BackoffPalombiEtAl:1997}, Fig.~3.  Best result ({\color{blue} Blue}) shown in figure below. }
\label{fig:DS_ClickRecovery_result}  
\end{figure}


% \begin{figure}
%   \includegraphics[width=0.5\textwidth]{DS_ClickRecovery_OptVars.eps}\\
% %  \includegraphics[width=0.5\textwidth]{DS_ClickRecovery_Output.eps}\label{Ch3:fig:DSClickRecoveryOutput}
%   \caption{Final Output Data of the D-stellate Click Recovery optimisation }
% \end{figure}

% \begin{figure}
%   \includegraphics[keepaspectratio=true,width=0.8\textwidth]{DS_ClickRecovery_Example1.eps}\\
%   \includegraphics[keepaspectratio=true,width=0.8\textwidth]{DS_ClickRecovery_Example10.eps}\\
%   \includegraphics[keepaspectratio=true,width=0.8\textwidth]{DS_ClickRecovery_Example13.eps}\\
%   \includegraphics[keepaspectratio=true,width=0.8\textwidth]{DS_ClickRecovery_Example19.eps}\\
%   \caption{Click Recovery optimisation functions}
% \end{figure}


% \begin{figure}
%   \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{DS_ClickRecovery_result.eps}\\
% \end{figure}


% \begin{figure}
%   \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{DS_ClickRecovery_result1.eps}\\
% \end{figure}


% \begin{figure}
%   \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{DS_ClickRecovery_result2.eps}\\
%   \caption{Click Recovery optimisation }
% \end{figure}




% \begin{figure}
% \begin{center}
% \includegraphics[keepaspectratio=true]{DS_ClickRecovery_handtuned.eps}\\
% \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{DS_ClickRecovery_result_handtuned.eps}
% \caption{Handtuned}
% \label{hantuned}
% \end{center}
% \end{figure}

% \begin{figure}
% \begin{center}
% %\includegraphics[keepaspectratio=true]{DS_ClickRecovery_handtuned.eps}\\
% \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{gfx/DS_ClickRecovery_result_unweighted_8.eps}\\
% \includegraphics[keepaspectratio=true,angle=-90,width=0.8\textwidth]{gfx/DS_ClickRecovery_result_weighted_0.eps}
% \caption{Handtuned}
% \label{hantuned}
% \end{center}
% \end{figure}


%% Example optimisation points used by praxis 
% \begin{figure}
% \begin{center}
% %\includegraphics[keepaspectratio=true]{DS_ClickRecovery_handtuned.eps}\\
% \includegraphics[keepaspectratio=true,width=0.5\textwidth]{Praxis_123.eps}
% \includegraphics[keepaspectratio=true,width=0.5\textwidth]{Praxis_456.eps}
% \caption{Handtuned}
% \label{hantuned}
% \end{center}
% \end{figure}


% \clearpage
\newpage
\subsection{Verification}

 \subsection{Tone Response}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{RateLevel/psthsingle90.2.eps}%
% \includegraphics{RateLevel/DS_ratelevel.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{RateLevel/response_area.2.eps}%
% \includegraphics{RateLevel/response_area_log2.2.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% %\includegraphics{RateLevel/response_area.2.eps}
% \includegraphics{RateLevel/psthall90.2.eps}%
% \includegraphics{RateLevel/psthVlevel.2.eps}}
% \end{figure}


% \clearpage
 \subsection{Noise Response}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{NoiseRateLevel/psthsingle120.2.eps}%
% \includegraphics{NoiseRateLevel/DS_ratelevel.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{NoiseRateLevel/response_area.2.eps}%
% \includegraphics{NoiseRateLevel/response_area_log2.2.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% %\includegraphics{RateLevel/response_area.2.eps}
% \includegraphics{NoiseRateLevel/psthall90.2.eps}%
% \includegraphics{NoiseRateLevel/psthVlevel.2.eps}}
% \end{figure}


% \clearpage
 \subsection{Masked Noise and Tone}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{\includegraphics{MaskedRateLevel/psthsingle90.2.eps}\includegraphics{MaskedRateLevel/DS_ratelevel.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{MaskedRateLevel/response_area.2.eps}%
% \includegraphics{MaskedRateLevel/response_area_log2.2.eps}}
% \end{figure}

% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% %\includegraphics{RateLevel/response_area.2.eps}
% \includegraphics{MaskedRateLevel/psthall90.2.eps}%
% \includegraphics{MaskedRateLevel/psthVlevel.2.eps}}
% \end{figure}
% \clearpage
 \subsection{Masked Response Area}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{MaskedResponseCurve/psthsingle5810.2.eps}%
% \includegraphics{MaskedResponseCurve/DS_masked.eps}}
% \end{figure}
% \begin{figure}[h!]
% \centering\resizebox{\textwidth}{!}{%
% \includegraphics{MaskedResponseCurve/response_area.2.eps}%
% \includegraphics{MaskedResponseCurve/response_area_log2log2.2.eps}}
% \end{figure}

% \begin{figure}[h!] 
% \centering\resizebox{\textwidth}{!}{%
% %\includegraphics{RateLevel/response_area.2.eps}
% \includegraphics{MaskedResponseCurve/psthall5810.2.eps}%
% \includegraphics{MaskedResponseCurve/psthVmod.2.eps}}
% \end{figure}
% \clearpage

 

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "SimpleResponses"
%%% TeX-PDF-mode: nil
%%% End: 
