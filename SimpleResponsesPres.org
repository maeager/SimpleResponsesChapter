#+LaTeX_CLASS: beamer
#+MACRO: BEAMERMODE presentation
#+MACRO: BEAMERTHEME default
#+MACRO: BEAMERCOLORTHEME dove
#+MACRO: BEAMERSUBJECT cochlear nucleus, neural modelling, simple optimisation
#+MACRO: BEAMERINSTITUTE The University of Melbourne, Department of Otolaryngology, and the Bionic Ear Institute
#+TITLE: Constructing realistic microcircuits: the Cochlear Nucleus stellate model
#+AUTHOR: Michael A. Eager
#+LaTeX_header:\usepackage{xspace}\input{../manuscript/glossary}
#+LaTeX_header:\usepackage{palatino}
#+LaTeX_header:\usepackage{mathpazo}

* Chapter 3: Simple optimisation of the cochlear nucleus stellate network
** Introduction
Cochlear Nucleus Stellate Network
\par
#+begin_LaTeX
       \makebox[0pt][l]{\includegraphics[width=\columnwidth,keepaspectratio]{gfx/CNnetwork.jpg}}
#+end_LaTeX
    
** 
 Reasoning behind a detailed model of CN stellate cells
#+begin_LaTeX
       \makebox[0pt][l]{\includegraphics[width=\columnwidth,keepaspectratio]{../figures/May2003-Fig.png}}
#+end_LaTeX
\citep[][Speech Comm.]{May:2003}

** General methods in neural network models
``tono-topic'' connections in auditory system 
#+CAPTION:    Topographic connections in cochlear nucleus
#+LABEL:      fig:CNConn
#+ATTR_LaTeX: width=7cm
[[./CNConn.png]]

** Basics of Optimisation in NEURON

#+begin_LaTeX
\begin{lstlisting}
objref pvec
pvec = new Vector()    //List of parameters
...
func err(){ /* cost function */
...
}
...
proc runprax(){
     attr_praxis(0.0001, 0.001, 3)
     fit_praxis(NPARAMS,"err",&pvec.x[0])
}
\end{lstlisting}
#+end_LaTeX

* Golgi Cell Model: Fitting simple model to rate level data
** Golgi Cell Model :  Experimental evidence
Anatomical \citep{BensonBerglundEtAl:1996}
 - LSR fibers proj to GCD
Morphological \citep{FerragamoGoldingEtAl:1998a}
 - small cell (12-15 micron soma), uniform dendrites and axonal collaterals 100 micron 
Intracellular \cite{FerragamoGoldingEtAl:1998a} (mice, GCD /in vitro/)
 - type-I current clamp response
 - delay from shock to AN of 0.7 ms relative to the core VCN units.
Physiological \citep{GhoshalKim:1997} (marginal shell, 5 units)
 - monotonic response to tones and noise 
   
** Golgi Cell Model :  Key design factors
 - Choosing neural model: HH-type or Poisson
 - Problem of monotonic excitation at low level
  - added HSR to model to avoid added computation of MSR
 - Spread of ANF to GCD ARE broader than core VCN
#  - are we spoiling the broth too early? 

** Golgi Cell Model :  Implementation
 - Generate  auditory filterbank vectors (*L* and *H*) and golgi alpha function
 - Create Golgi vectors from AN vectors
  1. For each channel, create 2 Golgi weighted vector across filterbank:\mu = channel position, \sigma = spatial spread of LSR  connections to Golgi
  2. Create Golgi vectors by summating ANF inputs weighted by *w*   
  3. Convolve the golgi vector with the alpha synaptic function 
#+begin_LaTeX
\begin{eqnarray}
 w(i,j) = \frac{1}{\sigma \sqrt{2\pi}} \exp \left\{-\frac{(i-j)^2}{2\sigma^2}\right\}, i,j \in [0,nchannels-1] \\
\mathbf{g}_i = \sum^{i} w_L(i)\mathbf{L}_i + w_H(i)\mathbf{H}_i \\
\mathbf{G}_i = \mathbf{g}_i * f_{\alpha} 
\end{eqnarray}
#+end_LaTeX
 - Create spikes from golgi vectors using Jackson's spike generator 

** Golgi Cell Model :  Optimisation Procedure

#+begin_LaTeX
\noindent\begin{tabularx}{\linewidth}{|X|c|c|c|}\hline 
     \textbf{Parameters}      &  \textbf{Name}   & \textbf{Range} & \textbf{Best Values} \\\hline 
   Spatial spread $\ANFGLG$     &     $\sANFGLG$     &     [0,10]     & 2.48 \\\hline 
Dendritic Filter time constant& $\tau_{\ANFGLG}$ &    [0,20] ms   & 5.01\\\hline 
     Weighted sum of HSR      &    $\wHSRGLG$    &      [0,5]     & 0.517 \\\hline 
     Weighted sum of HSR      &    $\wLSRGLG$    &      [0,5]     & 0.0487\\\hline 
      Spontaneous Rate        &  \texttt{golgi\_spon} &  [0,50] sp/ms  & 3.73 \\\hline
\end{tabularx}
#+end_LaTeX

*Fitting Data*: 
 - monotonic rate-level curve, unit S03-07 (CF 21 kHz) Ghoshal and Kim (1997) 
*Optimisation*: 
 - Measure spike rate of golgi model at several sound levels, calc mean squared error between experimental data and golgi
  model data

** Golgi Cell Model :  Results


#+LaTeX:\makebox[0pt][l]{\includegraphics[angle=-90]{./gfx/GolgiRateLevel2}


** Golgi Cell Model :  Outcomes
 - Good fit of golgi model to Ghoshal and Kim data, using just the tone  rate-level.
 - Dominance of LSR weight parameter over HSR weight 
   - no evidence for HSR axons in GCD, here it adds a background effect similar to the granule cells or type-II ANFs 

* D-stellate (DS) Cell Model: GABAergic effects on click recovery
** D Stellate Cell Model:  Experimental evidence
Morphological 
 - large Multipolar cell
 - electrotonic dendrites stretching 200 microns (one third of VCN), one half DCN, cCN 
 - receive large number of ANF syn to dend and soma
 - receive large number of Gly and GABA syn to soma dend
Intracellular
 - type I-II current clamp response
 - presence of Ih and small amounts of KLT currents
 - delay from shock to ANFs less than 1 ms 
Physiological 
 - Onset chopper PSTH, fast narrow FSL 
 - Wide response area (+1 oct and -2 oct)
 - high sync index, Low-pass MTF
 - monotonic response to tones and noise 

** D Stellate Cell Model:  Key design factors
- counter intuitive: slow synapse controlling click recovery less than
  the delay and time constant of the synapse => add KLT and leak
  conductance to change Rothman and Manis CN model
- DS-DS possible \citep{FerragamoGoldingEtAl:1998}, TV-DS possible \citep{ZhangOertel:1993b}
- limit simulation time reduced due to golgi and Poisson models
  providing input to single DS cell model

** D Stellate Cell Model:  Implementation

- Generate AN vectors in auditory filterbank
- Create Golgi filterbank
- Pass AN and Golgi spikes onto single DS cell model in NEURON

** D Stellate Cell Model : Optimisation Procedure
#+begin_LaTeX
\begin{tabularx}{\textwidth}{XXXX} 
\textbf{Parameters} &        \textbf{Range}         & \\ \hline
     \textbf{Parameters}      &  \textbf{Name}   & \textbf{Range} & \textbf{Best Values} \\\hline 
Weight of HSR syn on DS       &        \wHSRDS       &         [0.01,50] nS          &$0.532 \quad{\rm nS}$ \\          
Weight of LSR syn on DS       &        \wLSRDS       &         [0.01,50] nS          &$0.16 \quad{\rm nS}$\\            
\GABAa synapse rise constant  &    $\tau_{GABA1}$    &        [0.01,10.0] ms         &$13.1 \quad{\rm nS}$\\            
\GABAa synapse decay constant &    $\tau_{GABA2}$    &         [0.1,50.0] ms         &$5.432 \quad{\rm ms}$\\           
DS cell leak conductance      &   $\bar{g}_{leak}$   & [0.01,50] $\mu{\rm Scm}^{-2}$ &$0.262 \quad{\rm ms}$\\           
\end{tabularx}									      $0.0163 \quad\mathrm{Scm}^{-2}$\\ 
\begin{tabularx}{\textwidth}{lcX} 
\textbf{Fixed Parameters} & \textbf{Value}& \\ \hline
         \nGLGDS          &            25             & Number of GABA syn on DS cells                                                                                                                                                  \\
         \dGLGDS          &          0.5 ms           & Combination of conductance and synaptic delay.  \\
\end{tabularx}
#+end_LaTeX

** D Stellate Cell Model:  Optimisation Procedure

*Fitting Data*: 
 - Click recovery data from \citep{BackoffPalombiEtAl:1997}
*Optimisation*:
 - Mask/Recovery clicks with recovery periods (2,3,4,8,16 ms)  
 - Measure DS cell recovery response for 2ms 
 - Calc mean squared error normalised to masking response
 - Huristics: Weighting required to ensure short periods recovered

** D Stellate Cell Model:  Results

#+LaTeX:\includegraphics[keepaspectratio=true,angle=-90,width=0.9\textwidth]{./gfx/DS_ClickRecovery_result}
   
** D Stellate Cell Model:  Results
*Error*  
 - 0.006671    unweighted (MSE of recovery spike rate / mask rate)
 - 0.01447    final result (MSE of recovery spike rate / mask rate)

** D Stellate Cell Model:  Outcomes

- DS cell model and synaptic inputs are fitted to a reasonable degree
- Weighting procedure was needed to emphasise curvature of recovery at narrow click separation

* Tuberculoventral Cell Model: Asymmetric wide-band inhibition affects TV response to notch noise
** Tuberculoventral Cell Model:  Experimental evidence
Morphological 
 - vertical/multipolar cell in deep layer of DCN \citep{Rhode:1999}
 - receive small  number of ANF syn to dend 
 - receive large number of Gly and GABA syn to soma dend
Intracellular \citep{OertelWickesberg:1993}
 - type I current clamp response
 - presence of glycine
Physiological \citep{Rhode:1999,SpirouDavisEtAl:1999}
 - type II, wide chopper PSTH 
 - Narrow response area, non-monotonic RL
 - poor response to noise and clicks
 - asymmetric response to notch noise \citep{ReissYoung:2005}

** Tuberculoventral Cell Model:  Key design factors

Notch noise stimulus => need more TV cells across frequency
input SPL and weight of excitation affect spiking output
Rat model (no TS-TV) but has been shown in other small mammals
 

** Tuberculoventral Cell Model:  Implementation
 - Generate AN vectors in auditory filterbank
 - Create Golgi vectors from AN vectors
 - Generate  AN and Golgi spikes 
 - TV and DS cell models simulated in NEURON

** Tuberculoventral Cell Model:  Optimisation Procedure
#+begin_LaTeX
\begin{tabularx}{\linewidth}{XXXX}
     \textbf{Parameters}      &  \textbf{Name}   & \textbf{Range} & \textbf{Best Values} \\\hline 
Weight of DS syn on TV                           &       \wDSTV        &  [0.01,50] nS  & 0.0029 $\mu$S\\
Weight of ANF syn on TV                          &       \wANFTV       &  [0.01,50] nS  & 0.00017 $\mu$S\\
No.~LSR to TV                                    &       \nLSRTV       &     [0,64]     & 8           \\
No.~HSR to TV                                    &       \nHSRTV       &     [0,64]     & 14          \\
Spread of DS connections onto TV                 &       \sDSTV        &     [0,10]     & 2.1         \\
Offset of DS connections onto TV &       \oDSTV        &     [0,10]     & 0.24        \\
\end{tabularx}
#+end_LaTeX

*Fitting Data*: 
 - Notch noise data from \citep{ReissYoung:2005} 
*Optimisation*: 
 - Measure DS and TV response across network.  Calc
  mean squared error between Reiss data and TV mean rate response (Weighting required)

# ** Tuberculoventral Cell Model:  Results

# #+CAPTION:    Tuberculoventral, DS and golgi rate-place response to 10 kHz, 1/2 oct Notch noise
# #+LABEL:      fig:TV_rateplace
# #+ATTR_LaTeX: width=0.8\columnwidth clip
#    [[gfx/CN_rateplace_10_05.pdf]]

# ** Tuberculoventral Cell Model:  Results

# #+LaTeX:\includegraphics[keepaspectratio=true,clip,width=0.9\textwidth]{./gfx/CN_rateplace_10_05.pdf}
 
** Tuberculoventral Cell Model:  Results

*Error*  0.0167  (MSE Normalised rate between 5-40kHz channels)
 - only one run before ANS, needs more verification 

** Tuberculoventral Cell Model:  Outcomes
 - Parallel simulation of full network CN model
 - 

* Bibliography

 #+BIBLIOGRAPHY: ../manuscript/bib/MyBib plainnat 

# option:-d

# #+begin_LaTeX
#  \bibliographystyle{plainnatt}
#  \bibliography{../manuscript/bib/MyBibt}
# #+end_LaTeX


## Some Hints

# For technical presentations, motivation is key 
# Why did you, as
# speaker, take the bus across town or the train halfway across Europe
# or a transatlantic flight just to come and talk about this stuff?  
# Why did the audience turn up at your session? Presumably something in the
# title or abstract caught their eye. (Perhaps they're only here to
# listen to the talk AFTER yours!).  Just getting up from your desk to
# come to the presentation shows some level of motivation from you AND
# the audience. Honour that motivation.  Why is what you're presenting
# important?  
# Why should they (the audience) be interested?  What is it
# about your findings that might be applicable to somebody else and move
# forward their understanding of this area? HINT - it's not page after
# page of detailed methods!!


# Manuscript structure:
# Introduction
# Methods
# Results
# Discussion
# Conclusions
# Peer review presentation structure
# Introduction Motivation
# Premise / Conclusions
# Methods
# Results
# Conclusions Applicability / Applications.
# Discussion, assumptions, caveats, applicability to other cases

# Peer Review:

# SPEAKER WANTS technical review, input, ideas, validation of
# work. AUDIENCE WANTS to know how ideas might be applicable to their
# situation.  Presenter likely to have worked on this topic for
# considerable time. Understands the data, context etc. Audience don't
# have this information SO need to spend reasonable amount of time
# explaining context, assumptions, specifics of this
# situation. (Fantastic post by Zen Faulkes on this topic).  Ensure that
# your presentation meets the needs of BOTH you and the audience
# i.e. Don't just show how clever you are - aim to get to the point
# where the audience understands and can give you what YOU want out of
# the meeting (ideas, feedback, new direction). HELP the audience to see
# how what you're presenting could be applicable for them (application
# in new areas, lessons learned etc).  If you over-egg technical stuff
# then audience split into 2 camps: Engaged but lost / Disengaged and
# thinking of other stuff. Type 1 turns into Type 2 quite quickly if you
# don't work hard to get them back. Stop & check understanding from time
# to time. Summarise. Paraphrase. Recap. Don't just ask "Any
# questions?".  For peer review of ALL technical details - write a
# manuscript. DON'T present.
